"use strict";
var __values = (this && this.__values) || function (o) {
    var m = typeof Symbol === "function" && o[Symbol.iterator], i = 0;
    if (m) return m.call(o);
    return {
        next: function () {
            if (o && i >= o.length) o = void 0;
            return { value: o && o[i++], done: !o };
        }
    };
};
var __read = (this && this.__read) || function (o, n) {
    var m = typeof Symbol === "function" && o[Symbol.iterator];
    if (!m) return o;
    var i = m.call(o), r, ar = [], e;
    try {
        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);
    }
    catch (error) { e = { error: error }; }
    finally {
        try {
            if (r && !r.done && (m = i["return"])) m.call(i);
        }
        finally { if (e) throw e.error; }
    }
    return ar;
};
Object.defineProperty(exports, "__esModule", { value: true });
var insight_1 = require("../core/insight");
var frequencyLimiter_1 = require("../helpers/frequencyLimiter");
var hottagEvent = insight_1.internalInsightShouldNotUsedByBusiness &&
    insight_1.internalInsightShouldNotUsedByBusiness.register("hottag", {
        level: insight_1.internalInsightShouldNotUsedByBusiness.EventLevel.Info,
    });
var imageLoadErrorEvent = insight_1.internalInsightShouldNotUsedByBusiness &&
    insight_1.internalInsightShouldNotUsedByBusiness.register("image-load-error", {
        level: insight_1.internalInsightShouldNotUsedByBusiness.EventLevel.Error,
    });
var hotTagLimiter = new frequencyLimiter_1.FrequencyLimiter({ name: "insight.reportHotTag" });
var statLimiter = new frequencyLimiter_1.FrequencyLimiter({ name: "insight.stat" });
var imageErrorLimiter = new frequencyLimiter_1.FrequencyLimiter({
    name: "insight.reportImageError",
});
exports.insight = {
    /**
     * 上报点击流
     * @param tag 点击标识
     */
    reportHotTag: function (tag) {
        if (typeof insight_1.internalInsightShouldNotUsedByBusiness !== "object") {
            return;
        }
        if (!tag || !hottagEvent) {
            return;
        }
        hotTagLimiter.exec(function () { return hottagEvent.push({ hottag: String(tag) }, true); });
    },
    /**
     * 上报图片加载错误
     * @param {string} imageUrl 图片 url
     */
    reportImageLoadError: function (imageUrl) {
        if (typeof insight_1.internalInsightShouldNotUsedByBusiness !== "object") {
            return;
        }
        if (!imageUrl || !imageLoadErrorEvent) {
            return;
        }
        imageErrorLimiter.exec(function () {
            return imageLoadErrorEvent.push({ url: String(imageUrl) }, true);
        });
    },
    /**
     * 自定义上报，如果 ns 和 event 参数不正确，会扔出异常
     *
     * 控制台在预览模式或开发模式不会上报，如果要验证效果，请在手动添加标识到 localStorage:
     *
     * ```js
     * localStorage.debugInsight = true
     * ```
     *
     * 然后刷新页面。
     *
     * @example
     *
      ```js
      import { app } from '@tea/app';
  
      app.insight.stat({
        ns: 'cvm',
        event: 'restart',
        stringFields: {
          instance: 'ins-1d7x8C3s'
        },
        integerFields: {
          cost: 1000
        }
      });
    ```
     */
    stat: function (_a) {
        var ns = _a.ns, event = _a.event, integerFields = _a.integerFields, stringFields = _a.stringFields;
        if (typeof insight_1.internalInsightShouldNotUsedByBusiness !== "object") {
            return;
        }
        if (!ns)
            throw new Error("ns 不能为空");
        if (!/^[a-zA-Z1-9\/]+$/.test(ns)) {
            throw new Error("ns 只允许包括字母、数字、斜杠");
        }
        else if (/^\/|\/$/.test(ns)) {
            throw new Error("ns 使用的斜杠不允许出现在首尾");
        }
        if (!event)
            throw new Error("event 不能为空");
        if (!/^[a-zA-Z1-9\-]+$/.test(event)) {
            throw new Error("event 只允许包括字母、数字、横杠");
        }
        else if (/^-|-$/.test(event)) {
            throw new Error("event 使用的横杠不允许出现在首尾");
        }
        statLimiter.exec(function () {
            var e_1, _a, e_2, _b;
            var stat = [ns, event].join(":");
            var data = {};
            var totalLimit = 20;
            if (integerFields) {
                try {
                    for (var _c = __values(Object.entries(integerFields)), _d = _c.next(); !_d.done; _d = _c.next()) {
                        var _e = __read(_d.value, 2), field = _e[0], value = _e[1];
                        if (totalLimit >= 0 && typeof value === "number" && !isNaN(value)) {
                            totalLimit--;
                            data["int_" + field] = Math.round(value);
                        }
                    }
                }
                catch (e_1_1) { e_1 = { error: e_1_1 }; }
                finally {
                    try {
                        if (_d && !_d.done && (_a = _c.return)) _a.call(_c);
                    }
                    finally { if (e_1) throw e_1.error; }
                }
            }
            if (stringFields) {
                try {
                    for (var _f = __values(Object.entries(stringFields)), _g = _f.next(); !_g.done; _g = _f.next()) {
                        var _h = __read(_g.value, 2), field = _h[0], value = _h[1];
                        if (totalLimit >= 0 && typeof value === "string") {
                            totalLimit--;
                            data["str_" + field] = value.slice(0, 4096);
                        }
                    }
                }
                catch (e_2_1) { e_2 = { error: e_2_1 }; }
                finally {
                    try {
                        if (_g && !_g.done && (_b = _f.return)) _b.call(_f);
                    }
                    finally { if (e_2) throw e_2.error; }
                }
            }
            insight_1.internalInsightShouldNotUsedByBusiness.stat(stat, data);
        });
    },
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5zaWdodC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9icmlkZ2UvaW5zaWdodC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUEsMkNBQXFGO0FBQ3JGLGdFQUErRDtBQUUvRCxJQUFNLFdBQVcsR0FDZixnREFBUTtJQUNSLGdEQUFRLENBQUMsUUFBUSxDQUFDLFFBQVEsRUFBRTtRQUMxQixLQUFLLEVBQUUsZ0RBQVEsQ0FBQyxVQUFVLENBQUMsSUFBSTtLQUNoQyxDQUFDLENBQUM7QUFFTCxJQUFNLG1CQUFtQixHQUN2QixnREFBUTtJQUNSLGdEQUFRLENBQUMsUUFBUSxDQUFDLGtCQUFrQixFQUFFO1FBQ3BDLEtBQUssRUFBRSxnREFBUSxDQUFDLFVBQVUsQ0FBQyxLQUFLO0tBQ2pDLENBQUMsQ0FBQztBQUVMLElBQU0sYUFBYSxHQUFHLElBQUksbUNBQWdCLENBQUMsRUFBRSxJQUFJLEVBQUUsc0JBQXNCLEVBQUUsQ0FBQyxDQUFDO0FBQzdFLElBQU0sV0FBVyxHQUFHLElBQUksbUNBQWdCLENBQUMsRUFBRSxJQUFJLEVBQUUsY0FBYyxFQUFFLENBQUMsQ0FBQztBQUNuRSxJQUFNLGlCQUFpQixHQUFHLElBQUksbUNBQWdCLENBQUM7SUFDN0MsSUFBSSxFQUFFLDBCQUEwQjtDQUNqQyxDQUFDLENBQUM7QUFFVSxRQUFBLE9BQU8sR0FBRztJQUNyQjs7O09BR0c7SUFDSCxZQUFZLEVBQVosVUFBYSxHQUFXO1FBQ3RCLElBQUksT0FBTyxnREFBUSxLQUFLLFFBQVEsRUFBRTtZQUNoQyxPQUFPO1NBQ1I7UUFDRCxJQUFJLENBQUMsR0FBRyxJQUFJLENBQUMsV0FBVyxFQUFFO1lBQ3hCLE9BQU87U0FDUjtRQUNELGFBQWEsQ0FBQyxJQUFJLENBQUMsY0FBTSxPQUFBLFdBQVcsQ0FBQyxJQUFJLENBQUMsRUFBRSxNQUFNLEVBQUUsTUFBTSxDQUFDLEdBQUcsQ0FBQyxFQUFF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RUFBRSxJQUFJLENBQUMsQ0FBQzt5QkFDN0M7cUJBQ0Y7Ozs7Ozs7OzthQUNGO1lBRUQsZ0RBQVEsQ0FBQyxJQUFJLENBQUMsSUFBSSxFQUFFLElBQUksQ0FBQyxDQUFDO1FBQzVCLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQztDQUNGLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBpbnRlcm5hbEluc2lnaHRTaG91bGROb3RVc2VkQnlCdXNpbmVzcyBhcyBfaW5zaWdodCB9IGZyb20gXCIuLi9jb3JlL2luc2lnaHRcIjtcbmltcG9ydCB7IEZyZXF1ZW5jeUxpbWl0ZXIgfSBmcm9tIFwiLi4vaGVscGVycy9mcmVxdWVuY3lMaW1pdGVyXCI7XG5cbmNvbnN0IGhvdHRhZ0V2ZW50ID1cbiAgX2luc2lnaHQgJiZcbiAgX2luc2lnaHQucmVnaXN0ZXIoXCJob3R0YWdcIiwge1xuICAgIGxldmVsOiBfaW5zaWdodC5FdmVudExldmVsLkluZm8sXG4gIH0pO1xuXG5jb25zdCBpbWFnZUxvYWRFcnJvckV2ZW50ID1cbiAgX2luc2lnaHQgJiZcbiAgX2luc2lnaHQucmVnaXN0ZXIoXCJpbWFnZS1sb2FkLWVycm9yXCIsIHtcbiAgICBsZXZlbDogX2luc2lnaHQuRXZlbnRMZXZlbC5FcnJvcixcbiAgfSk7XG5cbmNvbnN0IGhvdFRhZ0xpbWl0ZXIgPSBuZXcgRnJlcXVlbmN5TGltaXRlcih7IG5hbWU6IFwiaW5zaWdodC5yZXBvcnRIb3RUYWdcIiB9KTtcbmNvbnN0IHN0YXRMaW1pdGVyID0gbmV3IEZyZXF1ZW5jeUxpbWl0ZXIoeyBuYW1lOiBcImluc2lnaHQuc3RhdFwiIH0pO1xuY29uc3QgaW1hZ2VFcnJvckxpbWl0ZXIgPSBuZXcgRnJlcXVlbmN5TGltaXRlcih7XG4gIG5hbWU6IFwiaW5zaWdodC5yZXBvcnRJbWFnZUVycm9yXCIsXG59KTtcblxuZXhwb3J0IGNvbnN0IGluc2lnaHQgPSB7XG4gIC8qKlxuICAgKiDkuIrmiqXngrnlh7vmtYFcbiAgICogQHBhcmFtIHRhZyDngrnlh7vmoIfor4ZcbiAgICovXG4gIHJlcG9ydEhvdFRhZyh0YWc6IHN0cmluZyk6IHZvaWQge1xuICAgIGlmICh0eXBlb2YgX2luc2lnaHQgIT09IFwib2JqZWN0XCIpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKCF0YWcgfHwgIWhvdHRhZ0V2ZW50KSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGhvdFRhZ0xpbWl0ZXIuZXhlYygoKSA9PiBob3R0YWdFdmVudC5wdXNoKHsgaG90dGFnOiBTdHJpbmcodGFnKSB9LCB0cnVlKSk7XG4gIH0sXG5cbiAgLyoqXG4gICAqIOS4iuaKpeWbvueJh+WKoOi9vemUmeivr1xuICAgKiBAcGFyYW0ge3N0cmluZ30gaW1hZ2VVcmwg5Zu+54mHIHVybFxuICAgKi9cbiAgcmVwb3J0SW1hZ2VMb2FkRXJyb3IoaW1hZ2VVcmw6IHN0cmluZyk6IHZvaWQge1xuICAgIGlmICh0eXBlb2YgX2luc2lnaHQgIT09IFwib2JqZWN0XCIpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKCFpbWFnZVVybCB8fCAhaW1hZ2VMb2FkRXJyb3JFdmVudCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpbWFnZUVycm9yTGltaXRlci5leGVjKCgpID0+XG4gICAgICBpbWFnZUxvYWRFcnJvckV2ZW50LnB1c2goeyB1cmw6IFN0cmluZyhpbWFnZVVybCkgfSwgdHJ1ZSlcbiAgICApO1xuICB9LFxuXG4gIC8qKlxuICAgKiDoh6rlrprkuYnkuIrmiqXvvIzlpoLmnpwgbnMg5ZKMIGV2ZW50IOWPguaVsOS4jeato+ehru+8jOS8muaJlOWHuuW8guW4uFxuICAgKlxuICAgKiDmjqfliLblj7DlnKjpooTop4jmqKHlvI/miJblvIDlj5HmqKHlvI/kuI3kvJrkuIrmiqXvvIzlpoLmnpzopoHpqozor4HmlYjmnpzvvIzor7flnKjmiYvliqjmt7vliqDmoIfor4bliLAgbG9jYWxTdG9yYWdlOlxuICAgKlxuICAgKiBgYGBqc1xuICAgKiBsb2NhbFN0b3JhZ2UuZGVidWdJbnNpZ2h0ID0gdHJ1ZVxuICAgKiBgYGBcbiAgICpcbiAgICog54S25ZCO5Yi35paw6aG16Z2i44CCXG4gICAqXG4gICAqIEBleGFtcGxlXG4gICAqXG4gICAgYGBganNcbiAgICBpbXBvcnQgeyBhcHAgfSBmcm9tICdAdGVhL2FwcCc7XG5cbiAgICBhcHAuaW5zaWdodC5zdGF0KHtcbiAgICAgIG5zOiAnY3ZtJyxcbiAgICAgIGV2ZW50OiAncmVzdGFydCcsXG4gICAgICBzdHJpbmdGaWVsZHM6IHtcbiAgICAgICAgaW5zdGFuY2U6ICdpbnMtMWQ3eDhDM3MnXG4gICAgICB9LFxuICAgICAgaW50ZWdlckZpZWxkczoge1xuICAgICAgICBjb3N0OiAxMDAwXG4gICAgICB9XG4gICAgfSk7XG4gIGBgYFxuICAgKi9cbiAgc3RhdCh7IG5zLCBldmVudCwgaW50ZWdlckZpZWxkcywgc3RyaW5nRmllbGRzIH06IEluc2lnaHRTdGF0KSB7XG4gICAgaWYgKHR5cGVvZiBfaW5zaWdodCAhPT0gXCJvYmplY3RcIikge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAoIW5zKSB0aHJvdyBuZXcgRXJyb3IoXCJucyDkuI3og73kuLrnqbpcIik7XG4gICAgaWYgKCEvXlthLXpBLVoxLTlcXC9dKyQvLnRlc3QobnMpKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJucyDlj6rlhYHorrjljIXmi6zlrZfmr43jgIHmlbDlrZfjgIHmlpzmnaBcIik7XG4gICAgfSBlbHNlIGlmICgvXlxcL3xcXC8kLy50ZXN0KG5zKSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFwibnMg5L2/55So55qE5pac5p2g5LiN5YWB6K645Ye6546w5Zyo6aaW5bC+XCIpO1xuICAgIH1cblxuICAgIGlmICghZXZlbnQpIHRocm93IG5ldyBFcnJvcihcImV2ZW50IOS4jeiDveS4uuepulwiKTtcbiAgICBpZiAoIS9eW2EtekEtWjEtOVxcLV0rJC8udGVzdChldmVudCkpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcImV2ZW50IOWPquWFgeiuuOWMheaLrOWtl+avjeOAgeaVsOWtl+OAgeaoquadoFwiKTtcbiAgICB9IGVsc2UgaWYgKC9eLXwtJC8udGVzdChldmVudCkpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcImV2ZW50IOS9v+eUqOeahOaoquadoOS4jeWFgeiuuOWHuueOsOWcqOmmluWwvlwiKTtcbiAgICB9XG5cbiAgICBzdGF0TGltaXRlci5leGVjKCgpID0+IHtcbiAgICAgIGNvbnN0IHN0YXQgPSBbbnMsIGV2ZW50XS5qb2luKFwiOlwiKTtcbiAgICAgIGNvbnN0IGRhdGEgPSB7fTtcblxuICAgICAgbGV0IHRvdGFsTGltaXQgPSAyMDtcbiAgICAgIGlmIChpbnRlZ2VyRmllbGRzKSB7XG4gICAgICAgIGZvciAobGV0IFtmaWVsZCwgdmFsdWVdIG9mIE9iamVjdC5lbnRyaWVzKGludGVnZXJGaWVsZHMpKSB7XG4gICAgICAgICAgaWYgKHRvdGFsTGltaXQgPj0gMCAmJiB0eXBlb2YgdmFsdWUgPT09IFwibnVtYmVyXCIgJiYgIWlzTmFOKHZhbHVlKSkge1xuICAgICAgICAgICAgdG90YWxMaW1pdC0tO1xuICAgICAgICAgICAgZGF0YVtgaW50XyR7ZmllbGR9YF0gPSBNYXRoLnJvdW5kKHZhbHVlKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmIChzdHJpbmdGaWVsZHMpIHtcbiAgICAgICAgZm9yIChsZXQgW2ZpZWxkLCB2YWx1ZV0gb2YgT2JqZWN0LmVudHJpZXMoc3RyaW5nRmllbGRzKSkge1xuICAgICAgICAgIGlmICh0b3RhbExpbWl0ID49IDAgJiYgdHlwZW9mIHZhbHVlID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICB0b3RhbExpbWl0LS07XG4gICAgICAgICAgICBkYXRhW2BzdHJfJHtmaWVsZH1gXSA9IHZhbHVlLnNsaWNlKDAsIDQwOTYpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBfaW5zaWdodC5zdGF0KHN0YXQsIGRhdGEpO1xuICAgIH0pO1xuICB9LFxufTtcblxuZXhwb3J0IGludGVyZmFjZSBJbnNpZ2h0U3RhdCB7XG4gIC8qKlxuICAgKiDkuLrkuobkuI3kuI7lhbbku5bkuJrliqHnmoTmlbDmja7lhrLnqoHvvIzpnIDopoHliLblrprkuIrmiqXnmoTlkb3lkI3nqbrpl7TvvIzlpoIgXCJjdm1cIlxuICAgKlxuICAgKiDlkb3lkI3nqbrpl7TlhYHorrjkvb/nlKjnmoTlrZfnrKbvvJrlrZfmr43jgIHmlbDlrZfjgIHmlpzmnaAgYC9g77yI5LiN5YWB6K645Ye6546w5Zyo6aaW5bC+77yJ77yM5aaC77yaXG4gICAqXG4gICAqICAtIFwiY3ZtMlwiXG4gICAqICAtIFwiY3ZtL3NnXCJcbiAgICovXG4gIG5zOiBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIOacrOasoee7n+iuoeeahOS6i+S7tuWQjeensFxuICAgKlxuICAgKiDkuovku7blkI3lhYHorrjkvb/nlKjnmoTlrZfnrKbvvJrlrZfmr43jgIHmlbDlrZfjgIHmqKrmnaAgYC1g77yI5LiN5YWB6K645Ye6546w5Zyo6aaW5bC+77yJ77yM5aaC77yaXG4gICAqXG4gICAqICAtIFwicmVzdGFydC1mYWlsXCJcbiAgICogIC0gXCJtb3ZlMnJlY3ljbGVcIlxuICAgKi9cbiAgZXZlbnQ6IHN0cmluZztcblxuICAvKipcbiAgICog6Ieq5a6a5LmJ5pWw5o2u77yI5pW05pWw57G75Z6L77yJXG4gICAqXG4gICAqIOWmguaenOS8oOWFpeeahOaYr+S4jeaYryBudW1iZXIg57G75Z6L77yM5Lya6KKr5b+955Wl44CC5aaC5p6c5Lyg5YWl55qE5LiN5piv5pW05pWw77yM5Lya5L2/55SoIE1hdGgucm91bmQg5Y+W5pW044CCXG4gICAqL1xuICBpbnRlZ2VyRmllbGRzPzogUmVjb3JkPGFueSwgbnVtYmVyPjtcblxuICAvKipcbiAgICog6Ieq5a6a5LmJ5pWw5o2u77yI5a2X56ym5Liy57G75Z6L77yJXG4gICAqXG4gICAqIOWmguaenOS8oOWFpeeahOS4jeaYryBzdHJpbmcg57G75Z6L77yM5Lya6KKr5b+955Wl44CCXG4gICAqXG4gICAqIOWNleS4quWtl+auteeahOmVv+W6pu+8jOS4jeiDvei2hei/hyA0MDk277yM5ZCm5YiZ5Lya6KKr6KOB5YiHXG4gICAqL1xuICBzdHJpbmdGaWVsZHM/OiBSZWNvcmQ8YW55LCBzdHJpbmc+O1xufVxuIl19