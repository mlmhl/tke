import { Combine, StyledProps } from "../_type";
import { ControlledProps } from "../form/controlled";
import { CommonDropdownProps } from "../dropdown/Dropdown";

export interface CascaderBaseProps
  extends Combine<CommonDropdownProps, StyledProps> {
  /**
   * é€‰æ‹©æ•°æ®
   */
  data: CascaderData;

  /**
   * åŠ¨æ€åŠ è½½æ•°æ®ï¼Œ**éœ€è¦è¿”å› Promise**
   *
   * åœ¨ `data` ä¸­æŸçº§ `options` ä¸ºç©ºæ—¶è°ƒç”¨
   */
  onLoad?: (value: string[], options: CascaderOption[]) => Promise<void>;

  /**
   * æ˜¯å¦æ¯çº§é€‰é¡¹å˜åŒ–éƒ½è§¦å‘æ”¹å˜
   * @default false
   */
  changeOnSelect?: boolean;

  /**
   * æ˜¯å¦ä¸ºå¤šé€‰æ¨¡å¼
   *
   * ğŸš¨ å¤šé€‰æ¨¡å¼æš‚ä¸æ”¯æŒé…ç½® `changeOnSelect`
   *
   * @default false
   * @version 2.2.1
   */
  multiple?: boolean;

  /**
   * æ˜¯å¦æ”¯æŒæ¸…ç©º
   * @default false
   * @version 2.3.2
   */
  clearable?: boolean;

  /**
   * å ä½ç¬¦
   * @default "è¯·é€‰æ‹©"ï¼ˆå·²å¤„ç†å›½é™…åŒ–ï¼‰
   */
  placeholder?: string;

  /**
   * æ˜¯å¦ç¦ç”¨é€‰æ‹©
   * @default false
   */
  disabled?: boolean;
}

/**
 * å•é€‰æ¨¡å¼
 */
export interface CascaderSingleProps
  extends ControlledProps<
    string[],
    React.SyntheticEvent,
    { options: CascaderOption[]; event: React.MouseEvent }
  > {}

/**
 * å¤šé€‰æ¨¡å¼
 */
export interface CascaderMultipleProps
  extends ControlledProps<
    string[][],
    React.SyntheticEvent,
    { options: CascaderOption[][]; event: React.MouseEvent }
  > {}

export type CascaderProps = Combine<
  CascaderBaseProps,
  CascaderSingleProps | CascaderMultipleProps
>;

export interface CascaderOption {
  /**
   * é€‰é¡¹å€¼
   */
  value: string;

  /**
   * é€‰é¡¹æ ‡é¢˜
   */
  label: React.ReactNode;

  /**
   * å­çº§æ•°æ®
   */
  child?: CascaderData;
}

export interface CascaderData {
  /**
   * å½“å‰é€‰æ‹©é¢æ¿æ ‡é¢˜
   */
  title: React.ReactNode;

  /**
   * é¢æ¿å¸ƒå±€åˆ—æ•°ï¼Œæ”¯æŒ `1`, `2`, `4`
   * @default 4
   */
  col?: number;

  /**
   * é€‰é¡¹
   *
   * å½“è¯¥é¡¹ä¸ºç©ºæ—¶å°†è§¦å‘ `onLoad` åŠ è½½æ•°æ®
   */
  options?: CascaderOption[];
}

export interface CascaderBoxProps extends StyledProps {
  /**
   * é€‰æ‹©æ•°æ®
   */
  data: CascaderProps["data"];

  /**
   * å½“å‰é€‰æ‹©å€¼
   */
  value?: CascaderSingleProps["value"];

  /**
   * å½“å‰é€‰æ‹©å€¼å˜åŒ–å›è°ƒ
   */
  onChange: CascaderSingleProps["onChange"];

  /**
   * é€‰æ‹©å®Œæ¯•æ”¶èµ·ä¸‹æ‹‰æ¡†
   */
  onClose: () => void;

  /**
   * åŠ¨æ€åŠ è½½æ•°æ®
   */
  onLoad: CascaderProps["onLoad"];

  /**
   * æ˜¯å¦æ¯çº§é€‰é¡¹å˜åŒ–éƒ½è§¦å‘æ”¹å˜
   * @default false
   */
  changeOnSelect?: CascaderProps["changeOnSelect"];

  /**
   * ç±»åå‰ç¼€
   */
  classPrefix?: string;

  /**
   * æ˜¯å¦ä¸ºå¤šé€‰æ¨¡å¼
   */
  multiple?: boolean;

  /**
   * å¤šé€‰æ¨¡å¼ä¸‹æ˜¯å¦è¢«é€‰ä¸­
   */
  isSelected?: (value: string[]) => boolean;

  /**
   * å¤šé€‰æ¨¡å¼ä¸‹å–æ¶ˆé€‰æ‹©å›è°ƒ
   */
  onDeselect?: CascaderSingleProps["onChange"];
}

export interface CascaderLoadingProps {
  /**
   * åŠ¨æ€åŠ è½½æ•°æ®
   */
  onLoad: () => Promise<void>;
}
