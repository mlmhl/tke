import React, { useState } from "react";
import classNames from "classnames";
import { StyledProps } from "../_type";
import { useConfig } from "../_util/config-context";
import { Modal } from "../modal";

export interface ImagePreviewProps extends StyledProps {
  /**
   * 图片 url
   */
  src: string;
  /**
   * 预览图片 url
   */
  previewSrc: string;
  /**
   * 预览弹窗标题
   */
  previewTitle?: string;
}

/**
 * 图片预览
 */
export function ImagePreview(props: ImagePreviewProps) {
  const { classPrefix } = useConfig();
  const {
    style,
    src,
    previewSrc,
    className,
    previewTitle = "图片预览",
  } = props;
  const [visible, setVisible] = useState(false);

  return (
    <>
      <img
        style={style}
        alt="预览图片"
        src={src}
        className={classNames(className, `${classPrefix}-img__preview`)}
        title="点击查看大图"
        onClick={() => setVisible(true)}
      />
      <Modal
        className={`${classPrefix}-dialog--img`}
        visible={visible}
        caption={previewTitle}
        onClose={() => setVisible(false)}
        onExited={() => setVisible(false)}
      >
        <Modal.Body>
          <img src={previewSrc} alt="" />
        </Modal.Body>
      </Modal>
    </>
  );
}
