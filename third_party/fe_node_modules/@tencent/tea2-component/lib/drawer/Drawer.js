"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var tslib_1 = require("tslib");
var react_1 = tslib_1.__importStar(require("react"));
var react_dom_1 = tslib_1.__importDefault(require("react-dom"));
var classnames_1 = tslib_1.__importDefault(require("classnames"));
var create_rocket_1 = require("../_util/create-rocket");
var justify_1 = require("../justify");
var button_1 = require("../button");
var transition_1 = require("../transition");
var use_outside_click_1 = require("../_util/use-outside-click");
var heading_1 = require("../heading");
var config_context_1 = require("../_util/config-context");
var use_visible_transition_1 = require("../_util/use-visible-transition");
var call_both_1 = require("../_util/call-both");
var noop_1 = require("../_util/noop");
function Drawer(_a) {
    var _b;
    var className = _a.className, style = _a.style, children = _a.children, visible = _a.visible, _c = _a.onClose, onClose = _c === void 0 ? noop_1.noop : _c, _d = _a.onExited, onExited = _d === void 0 ? noop_1.noop : _d, size = _a.size, placement = _a.placement, footer = _a.footer, title = _a.title, subTitle = _a.subTitle, _e = _a.subtitle, subtitle = _e === void 0 ? subTitle : _e, extra = _a.extra, disableCloseIcon = _a.disableCloseIcon, disableAnimation = _a.disableAnimation, _f = _a.outerClickClosable, outerClickClosable = _f === void 0 ? true : _f, _g = _a.destroyOnClose, destroyOnClose = _g === void 0 ? true : _g;
    var classPrefix = config_context_1.useConfig().classPrefix;
    var ref = react_1.useRef(null);
    var _h = use_outside_click_1.useOutsideClick(ref), listen = _h.listen, ignoreProps = _h.ignoreProps;
    listen(function () { return outerClickClosable && visible && onClose(); });
    var width = size === "l" ? 800 : 320;
    var from = placement === "left" ? 0 - width : width;
    var showHeader = title || subtitle || extra || !disableCloseIcon;
    var _j = use_visible_transition_1.useVisibleTransition(visible), contentIn = _j.contentIn, shouldContentEnter = _j.shouldContentEnter, shouldContentRender = _j.shouldContentRender, onContentExit = _j.onContentExit;
    if (!shouldContentRender && destroyOnClose) {
        return null;
    }
    return react_dom_1.default.createPortal(react_1.default.createElement("div", { style: {
            display: !destroyOnClose && !contentIn ? "none" : undefined,
        } },
        react_1.default.createElement(transition_1.SlideTransition, { in: shouldContentEnter, from: [from, 0], timeout: disableAnimation ? 0 : undefined, unmountOnExit: destroyOnClose, onExited: call_both_1.callBoth(onExited, onContentExit) },
            react_1.default.createElement("div", tslib_1.__assign({ ref: ref, style: style, className: classnames_1.default(classPrefix + "-drawer", className, (_b = {},
                    _b[classPrefix + "-drawer--left"] = placement === "left",
                    _b["size-l"] = size === "l",
                    _b)) }, ignoreProps),
                showHeader && (react_1.default.createElement("div", { className: classPrefix + "-drawer__header" },
                    react_1.default.createElement(justify_1.Justify, { left: react_1.default.createElement(DrawerTitle, { title: title, subtitle: subtitle, classPrefix: classPrefix }), right: react_1.default.createElement(react_1.default.Fragment, null,
                            extra,
                            !disableCloseIcon && (react_1.default.createElement(button_1.Button, { icon: "close", onClick: onClose }))) }))),
                react_1.default.createElement(DrawerBody, null, children),
                footer && react_1.default.createElement(DrawerFooter, null, footer)))), document.body);
}
exports.Drawer = Drawer;
function DrawerTitle(_a) {
    var title = _a.title, subtitle = _a.subtitle, classPrefix = _a.classPrefix;
    var sub = typeof subtitle === "string" ? (react_1.default.createElement("span", { className: classPrefix + "-card__subtitle" }, subtitle)) : (subtitle);
    if (typeof title === "string") {
        return (react_1.default.createElement(heading_1.H3, null,
            title,
            sub));
    }
    return (react_1.default.createElement(react_1.default.Fragment, null,
        title,
        sub));
}
var DrawerBody = create_rocket_1.createRocket("DrawerBody", "div.@{prefix}-drawer__body", "div.@{prefix}-drawer__body-inner");
var DrawerFooter = create_rocket_1.createRocket("DrawerFooter", "div.@{prefix}-drawer__footer");
//# sourceMappingURL=Drawer.js.map